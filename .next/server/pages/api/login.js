"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/login";
exports.ids = ["pages/api/login"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "(api)/./jwtgenrate/jwttoken.js":
/*!********************************!*\
  !*** ./jwtgenrate/jwttoken.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nfunction jwtGen(user_id) {\n    const payload = {\n        user: user_id\n    };\n    return jwt.sign(payload, process.env.jwtSecret, {\n        expiresIn: \"1hr\"\n    });\n}\nmodule.exports = jwtGen;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9qd3RnZW5yYXRlL2p3dHRva2VuLmpzLmpzIiwibWFwcGluZ3MiOiJBQUNBO0FBQUEsTUFBTUEsR0FBRyxHQUFHQyxtQkFBTyxDQUFDLGtDQUFjLENBQUM7QUFJbkMsU0FBU0MsTUFBTSxDQUFDQyxPQUFPLEVBQUM7SUFDaEIsTUFBTUMsT0FBTyxHQUFHO1FBQ1pDLElBQUksRUFBRUYsT0FBTztLQUNoQjtJQUNILE9BQU9ILEdBQUcsQ0FBQ00sSUFBSSxDQUFDRixPQUFPLEVBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTLEVBQUM7UUFBQ0MsU0FBUyxFQUFFLEtBQUs7S0FBQyxDQUFDO0NBQ3RFO0FBRURDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHVixNQUFNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVzdGZyb250Ly4vand0Z2VucmF0ZS9qd3R0b2tlbi5qcz84N2UwIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5jb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGp3dEdlbih1c2VyX2lkKXtcclxuICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xyXG4gICAgICAgICAgICB1c2VyOiB1c2VyX2lkXHJcbiAgICAgICAgfVxyXG4gICAgICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCxwcm9jZXNzLmVudi5qd3RTZWNyZXQse2V4cGlyZXNJbjogXCIxaHJcIn0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gand0R2VuIl0sIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJqd3RHZW4iLCJ1c2VyX2lkIiwicGF5bG9hZCIsInVzZXIiLCJzaWduIiwicHJvY2VzcyIsImVudiIsImp3dFNlY3JldCIsImV4cGlyZXNJbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./jwtgenrate/jwttoken.js\n");

/***/ }),

/***/ "(api)/./middleware/auth.js":
/*!****************************!*\
  !*** ./middleware/auth.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _pages_api_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../pages/api/db */ \"(api)/./pages/api/db.js\");\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n(__webpack_require__(/*! dotenv */ \"dotenv\").config)();\n\nconst authorize = (handler)=>{\n    return async (req, res)=>{\n        try {\n            const email = req.body.email;\n            const user = await _pages_api_db__WEBPACK_IMPORTED_MODULE_0__.conn.query(\"SELECT * from users where user_email = $1\", [\n                email\n            ]);\n            if (!user.rows[0].user_email == email) {\n                res.status(401).json({\n                    error: \"user does not exist\"\n                });\n                console.log(\"no users\");\n            } else if (user.rows[0].verify != 1) {\n                console.log(user.rows[0].verify);\n                res.status(401).json({\n                    error: \"Email is not verified please verify your account\"\n                });\n            }\n        } catch (error) {\n            console.log(error);\n        }\n        return handler(req, res);\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (authorize);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9taWRkbGV3YXJlL2F1dGguanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxNQUFNQSxHQUFHLEdBQUdDLG1CQUFPLENBQUMsa0NBQWMsQ0FBQztBQUNuQ0Esb0RBQXdCLEVBQUU7QUFDWTtBQUN0QyxNQUFNRyxTQUFTLEdBQUcsQ0FBQ0MsT0FBTyxHQUFJO0lBQzlCLE9BQU8sT0FBTUMsR0FBRyxFQUFDQyxHQUFHLEdBQUk7UUFDcEIsSUFBSTtZQUNBLE1BQU1DLEtBQUssR0FBR0YsR0FBRyxDQUFDRyxJQUFJLENBQUNELEtBQUs7WUFFN0IsTUFBTUUsSUFBSSxHQUFHLE1BQU1QLHFEQUFVLENBQUMsMkNBQTJDLEVBQUM7Z0JBQUNLLEtBQUs7YUFBQyxDQUFDO1lBRWxGLElBQUcsQ0FBQ0UsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUVDLFVBQVUsSUFBSUwsS0FBSyxFQUFDO2dCQUNyQ0QsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBQ0MsS0FBSyxFQUFDLHFCQUFxQjtpQkFBQyxDQUFDO2dCQUNuREMsT0FBTyxDQUFDQyxHQUFHLENBQUMsVUFBVSxDQUFDO2FBQ3ZCLE1BRUcsSUFBR1IsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNPLE1BQU0sSUFBSSxDQUFDLEVBQUM7Z0JBQy9CRixPQUFPLENBQUNDLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNPLE1BQU0sQ0FBQztnQkFDaENaLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUNDLEtBQUssRUFBQyxrREFBa0Q7aUJBQUMsQ0FBQzthQUNoRjtTQUdILENBQUMsT0FBT0EsS0FBSyxFQUFFO1lBQ1pDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixLQUFLLENBQUM7U0FFckI7UUFDRCxPQUFPWCxPQUFPLENBQUNDLEdBQUcsRUFBQ0MsR0FBRyxDQUFDO0tBQzFCO0NBQ0E7QUFFRCxpRUFBZUgsU0FBUyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rlc3Rmcm9udC8uL21pZGRsZXdhcmUvYXV0aC5qcz8xYzljIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXHJcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXHJcbmltcG9ydCB7IGNvbm4gfSBmcm9tICcuLi9wYWdlcy9hcGkvZGInXHJcbmNvbnN0IGF1dGhvcml6ZSA9IChoYW5kbGVyKSA9PntcclxucmV0dXJuIGFzeW5jKHJlcSxyZXMpID0+e1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBlbWFpbCA9IHJlcS5ib2R5LmVtYWlsXHJcbiAgICAgICAgXHJcbiAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY29ubi5xdWVyeSgnU0VMRUNUICogZnJvbSB1c2VycyB3aGVyZSB1c2VyX2VtYWlsID0gJDEnLFtlbWFpbF0pO1xyXG4gICAgICAgXHJcbiAgICAgICBpZighdXNlci5yb3dzWzBdLiB1c2VyX2VtYWlsID09IGVtYWlsKXtcclxuICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7ZXJyb3I6XCJ1c2VyIGRvZXMgbm90IGV4aXN0XCJ9KVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdubyB1c2VycycpXHJcbiAgICAgICB9XHJcbiAgICAgICBcclxuICAgICAgZWxzZSBpZih1c2VyLnJvd3NbMF0udmVyaWZ5ICE9IDEpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXIucm93c1swXS52ZXJpZnkpXHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oe2Vycm9yOlwiRW1haWwgaXMgbm90IHZlcmlmaWVkIHBsZWFzZSB2ZXJpZnkgeW91ciBhY2NvdW50XCJ9KSAgXHJcbiAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgIFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhbmRsZXIocmVxLHJlcylcclxufVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhdXRob3JpemUiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImNvbmZpZyIsImNvbm4iLCJhdXRob3JpemUiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiZW1haWwiLCJib2R5IiwidXNlciIsInF1ZXJ5Iiwicm93cyIsInVzZXJfZW1haWwiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwidmVyaWZ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./middleware/auth.js\n");

/***/ }),

/***/ "(api)/./pages/api/db.js":
/*!*************************!*\
  !*** ./pages/api/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"conn\": () => (/* binding */ conn)\n/* harmony export */ });\n// import { Pool } from \"pg\";\n// let conn;\n// if(!conn){\n//     conn = new Pool({\n//         user: 'postgres',\n//         password: 'Thebalochcoder',\n//         host: 'localhost',\n//         port: 5432,\n//         database: 'testphase'\n//     });\n// }\n// export { conn };\n//  CLOUDE CONNECTION \nvar pg = __webpack_require__(/*! pg */ \"pg\");\n//or native libpq bindings\n//var pg = require('pg').native\nvar conString = process.env.DATABASE_URL //Can be found in the Details page\n;\nvar conn = new pg.Client(conString);\nconn.connect(function(err) {\n    if (err) {\n        console.error(\"could not connect to postgres\", err);\n        return conn = null;\n    }\n    conn.query('SELECT NOW() AS \"theTime\"', function(err, result) {\n        if (err) {\n            return console.error(\"error running query\", err);\n        }\n        console.log(\"DATABASE CONNECTED\");\n    // >> output: 2018-08-23T14:02:57.117Z\n    });\n});\n // CONNECTION POLLING METHOD\n // const { Pool } = require(\"pg\")\n // const pool = new Pool()\n // async function conn() {\n //   const client = await pool.connect()\n //   try {\n //     const res = await client.query(\"SELECT * FROM users WHERE id = $1\", [1])\n //     console.log(res.rows[0])\n //   } finally {\n //     await client.release()\n //     await client.end()\n //   }\n // }\n // export {conn}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZGIuanMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLDZCQUE2QjtBQUU3QixZQUFZO0FBQ1osYUFBYTtBQUNiLHdCQUF3QjtBQUN4Qiw0QkFBNEI7QUFDNUIsc0NBQXNDO0FBQ3RDLDZCQUE2QjtBQUM3QixzQkFBc0I7QUFDdEIsZ0NBQWdDO0FBQ2hDLFVBQVU7QUFFVixJQUFJO0FBRUosbUJBQW1CO0FBR25CLHNCQUFzQjtBQUN0QixJQUFJQSxFQUFFLEdBQUdDLG1CQUFPLENBQUMsY0FBSSxDQUFDO0FBQ3RCLDBCQUEwQjtBQUMxQiwrQkFBK0I7QUFFL0IsSUFBSUMsU0FBUyxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsWUFBWSxDQUFDLGtDQUFrQztBQUFuQztBQUN4QyxJQUFJQyxJQUFJLEdBQUksSUFBSU4sRUFBRSxDQUFDTyxNQUFNLENBQUNMLFNBQVMsQ0FBQztBQUNuQ0ksSUFBSSxDQUFDRSxPQUFPLENBQUMsU0FBU0MsR0FBRyxFQUFFO0lBQzFCLElBQUdBLEdBQUcsRUFBRTtRQUNOQyxPQUFPLENBQUNDLEtBQUssQ0FBQywrQkFBK0IsRUFBRUYsR0FBRyxDQUFDLENBQUM7UUFDcEQsT0FBT0gsSUFBSSxHQUFHLElBQUksQ0FBQztLQUNwQjtJQUNDQSxJQUFJLENBQUNNLEtBQUssQ0FBQywyQkFBMkIsRUFBRSxTQUFTSCxHQUFHLEVBQUVJLE1BQU0sRUFBRTtRQUM5RCxJQUFHSixHQUFHLEVBQUU7WUFDTixPQUFPQyxPQUFPLENBQUNDLEtBQUssQ0FBQyxxQkFBcUIsRUFBRUYsR0FBRyxDQUFDLENBQUM7U0FDbEQ7UUFDQ0MsT0FBTyxDQUFDSSxHQUFHLENBQUMsb0JBQW9CLENBQUM7SUFPbkMsc0NBQXNDO0tBRXZDLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQztBQUdhLENBRWhCLDRCQUE0QjtDQUc1QixpQ0FBaUM7Q0FDakMsMEJBQTBCO0NBRTFCLDBCQUEwQjtDQUMxQix3Q0FBd0M7Q0FDeEMsVUFBVTtDQUNWLCtFQUErRTtDQUMvRSwrQkFBK0I7Q0FDL0IsZ0JBQWdCO0NBQ2hCLDZCQUE2QjtDQUM3Qix5QkFBeUI7Q0FDekIsTUFBTTtDQUNOLElBQUk7Q0FDSixnQkFBZ0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXN0ZnJvbnQvLi9wYWdlcy9hcGkvZGIuanM/YjgxNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBQb29sIH0gZnJvbSBcInBnXCI7XHJcblxyXG4vLyBsZXQgY29ubjtcclxuLy8gaWYoIWNvbm4pe1xyXG4vLyAgICAgY29ubiA9IG5ldyBQb29sKHtcclxuLy8gICAgICAgICB1c2VyOiAncG9zdGdyZXMnLFxyXG4vLyAgICAgICAgIHBhc3N3b3JkOiAnVGhlYmFsb2NoY29kZXInLFxyXG4vLyAgICAgICAgIGhvc3Q6ICdsb2NhbGhvc3QnLFxyXG4vLyAgICAgICAgIHBvcnQ6IDU0MzIsXHJcbi8vICAgICAgICAgZGF0YWJhc2U6ICd0ZXN0cGhhc2UnXHJcbi8vICAgICB9KTtcclxuIFxyXG4vLyB9XHJcbiAgXHJcbi8vIGV4cG9ydCB7IGNvbm4gfTtcclxuICAgXHJcblxyXG4vLyAgQ0xPVURFIENPTk5FQ1RJT04gXHJcbnZhciBwZyA9IHJlcXVpcmUoJ3BnJylcclxuLy9vciBuYXRpdmUgbGlicHEgYmluZGluZ3NcclxuLy92YXIgcGcgPSByZXF1aXJlKCdwZycpLm5hdGl2ZVxyXG5cclxudmFyIGNvblN0cmluZyA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCAvL0NhbiBiZSBmb3VuZCBpbiB0aGUgRGV0YWlscyBwYWdlXHJcbnZhciBjb25uICA9IG5ldyBwZy5DbGllbnQoY29uU3RyaW5nKTtcclxuIGNvbm4uY29ubmVjdChmdW5jdGlvbihlcnIpIHtcclxuICBpZihlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ2NvdWxkIG5vdCBjb25uZWN0IHRvIHBvc3RncmVzJywgZXJyKTtcclxuICAgIHJldHVybiBjb25uID0gbnVsbDtcclxuICB9XHJcbiAgICBjb25uLnF1ZXJ5KCdTRUxFQ1QgTk9XKCkgQVMgXCJ0aGVUaW1lXCInLCBmdW5jdGlvbihlcnIsIHJlc3VsdCkge1xyXG4gICAgaWYoZXJyKSB7XHJcbiAgICAgIHJldHVybiBjb25zb2xlLmVycm9yKCdlcnJvciBydW5uaW5nIHF1ZXJ5JywgZXJyKTtcclxuICAgIH1cclxuICAgICAgY29uc29sZS5sb2coXCJEQVRBQkFTRSBDT05ORUNURURcIilcclxuICAgICAgICBcclxuICAgICBcclxuICAgICBcclxuICAgIFxyXG4gICAgIFxyXG4gICAgXHJcbiAgICAvLyA+PiBvdXRwdXQ6IDIwMTgtMDgtMjNUMTQ6MDI6NTcuMTE3WlxyXG4gXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuXHJcbmV4cG9ydCB7IGNvbm4gfTtcclxuXHJcbi8vIENPTk5FQ1RJT04gUE9MTElORyBNRVRIT0RcclxuXHJcblxyXG4vLyBjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoXCJwZ1wiKVxyXG4vLyBjb25zdCBwb29sID0gbmV3IFBvb2woKVxyXG5cclxuLy8gYXN5bmMgZnVuY3Rpb24gY29ubigpIHtcclxuLy8gICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKVxyXG4vLyAgIHRyeSB7XHJcbi8vICAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQucXVlcnkoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gJDFcIiwgWzFdKVxyXG4vLyAgICAgY29uc29sZS5sb2cocmVzLnJvd3NbMF0pXHJcbi8vICAgfSBmaW5hbGx5IHtcclxuLy8gICAgIGF3YWl0IGNsaWVudC5yZWxlYXNlKClcclxuLy8gICAgIGF3YWl0IGNsaWVudC5lbmQoKVxyXG4vLyAgIH1cclxuLy8gfVxyXG4vLyBleHBvcnQge2Nvbm59Il0sIm5hbWVzIjpbInBnIiwicmVxdWlyZSIsImNvblN0cmluZyIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJjb25uIiwiQ2xpZW50IiwiY29ubmVjdCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInF1ZXJ5IiwicmVzdWx0IiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/db.js\n");

/***/ }),

/***/ "(api)/./pages/api/login.js":
/*!****************************!*\
  !*** ./pages/api/login.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(api)/./pages/api/db.js\");\n/* harmony import */ var _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../jwtgenrate/jwttoken */ \"(api)/./jwtgenrate/jwttoken.js\");\n/* harmony import */ var _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _middleware_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../middleware/auth */ \"(api)/./middleware/auth.js\");\n\nconst bcrypt = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n\n\nfunction validEmail(email) {\n    return /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(email);\n}\nasync function handler(req, res) {\n    if (req.method == \"POST\") {\n        try {\n            // 1 destructure the req.body \n            const { email , password  } = req.body;\n            if (![\n                email,\n                password\n            ].every(Boolean)) {\n                res.status(400).json({\n                    error: \"Missing Credentials\"\n                });\n            } else if (!validEmail(email)) {\n                res.json({\n                    error: \"Invalid Email\"\n                });\n            }\n            // 2 check if user doesn,t exist (if not then throw error)\n            const user = await _db__WEBPACK_IMPORTED_MODULE_0__.conn.query(\"SELECT * FROM users WHERE user_email = $1\", [\n                email\n            ]);\n            if (!user) {\n                res.json({\n                    error: \"email does not exist \"\n                });\n            }\n            if (user.rows.length === 0) {\n                res.json({\n                    error: \"password or email is incorrect\"\n                });\n            }\n            // 3 check if incomming password is the same the database password\n            const validPassword = await bcrypt.compare(password, user.rows[0].user_password);\n            if (!validPassword) {\n                return res.json({\n                    error: \"password or email is incrroct\"\n                });\n            }\n            // 4 given them jwt token\n            const token = _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1___default()(user.rows[0].user_id);\n            res.json({\n                token,\n                user: user.rows\n            });\n        } catch (error) {\n            console.log(error);\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_middleware_auth__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(handler));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvbG9naW4uanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBeUI7QUFFekIsTUFBTUMsTUFBTSxHQUFHQyxtQkFBTyxDQUFDLHNCQUFRLENBQUM7QUFDYztBQUdEO0FBQzdDLFNBQVNHLFVBQVUsQ0FBQ0MsS0FBSyxFQUFFO0lBQ3pCLE9BQVEsZ0RBQWdEQyxJQUFJLENBQUNELEtBQUssQ0FBQyxDQUFDO0NBQ3JFO0FBQ0EsZUFBZ0JFLE9BQU8sQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEVBQUU7SUFDM0IsSUFBR0QsR0FBRyxDQUFDRSxNQUFNLElBQUksTUFBTSxFQUFDO1FBQ3BCLElBQUk7WUFDQSw4QkFBOEI7WUFDOUIsTUFBTSxFQUFDTCxLQUFLLEdBQUNNLFFBQVEsR0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7WUFFakMsSUFBSSxDQUFDO2dCQUFDUCxLQUFLO2dCQUFFTSxRQUFRO2FBQUMsQ0FBQ0UsS0FBSyxDQUFDQyxPQUFPLENBQUMsRUFBRTtnQkFDckNMLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUNDLEtBQUssRUFBQyxxQkFBcUI7aUJBQUMsQ0FBQyxDQUFDO2FBQ3BELE1BQU0sSUFBSSxDQUFDYixVQUFVLENBQUNDLEtBQUssQ0FBQyxFQUFFO2dCQUM3QkksR0FBRyxDQUFDTyxJQUFJLENBQUM7b0JBQUNDLEtBQUssRUFBRSxlQUFlO2lCQUFDLENBQUMsQ0FBQzthQUNwQztZQUNGLDBEQUEwRDtZQUMxRCxNQUFNQyxJQUFJLEdBQUcsTUFBTW5CLDJDQUFVLENBQUMsMkNBQTJDLEVBQ3pFO2dCQUFDTSxLQUFLO2FBQUMsQ0FBQztZQUVSLElBQUcsQ0FBQ2EsSUFBSSxFQUFDO2dCQUNWVCxHQUFHLENBQUNPLElBQUksQ0FBQztvQkFBQ0MsS0FBSyxFQUFDLHVCQUF1QjtpQkFBQyxDQUFDO2FBQ3ZDO1lBRUQsSUFBR0MsSUFBSSxDQUFDRSxJQUFJLENBQUNDLE1BQU0sS0FBSyxDQUFDLEVBQUM7Z0JBQ3ZCWixHQUFHLENBQUNPLElBQUksQ0FBQztvQkFBQ0MsS0FBSyxFQUFDLGdDQUFnQztpQkFBQyxDQUFDO2FBQ3BEO1lBRUQsa0VBQWtFO1lBQ2xFLE1BQU1LLGFBQWEsR0FBRyxNQUFNdEIsTUFBTSxDQUFDdUIsT0FBTyxDQUFDWixRQUFRLEVBQUNPLElBQUksQ0FBQ0UsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDSSxhQUFhLENBQUM7WUFHOUUsSUFBRyxDQUFDRixhQUFhLEVBQUM7Z0JBQ2pCLE9BQU9iLEdBQUcsQ0FBQ08sSUFBSSxDQUFDO29CQUFDQyxLQUFLLEVBQUMsK0JBQStCO2lCQUFDLENBQUM7YUFDeEQ7WUFDRix5QkFBeUI7WUFDekIsTUFBTVEsS0FBSyxHQUFJdkIsMkRBQU0sQ0FBQ2dCLElBQUksQ0FBQ0UsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDTSxPQUFPLENBQUM7WUFDM0NqQixHQUFHLENBQUNPLElBQUksQ0FBQztnQkFBQ1MsS0FBSztnQkFBRVAsSUFBSSxFQUFFQSxJQUFJLENBQUNFLElBQUk7YUFBQyxDQUFDO1NBR25DLENBQUMsT0FBT0gsS0FBSyxFQUFFO1lBQ2RVLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDWCxLQUFLLENBQUM7U0FDbkI7S0FFTjtDQUdOO0FBRUQsaUVBQWVkLDREQUFTLENBQUNJLE9BQU8sQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rlc3Rmcm9udC8uL3BhZ2VzL2FwaS9sb2dpbi5qcz9hZTg4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Y29ubn0gZnJvbSBcIi4vZGJcIlxyXG5cclxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0JylcclxuaW1wb3J0IGp3dEdlbiBmcm9tIFwiLi4vLi4vand0Z2VucmF0ZS9qd3R0b2tlblwiXHJcblxyXG5cclxuaW1wb3J0IGF1dGhvcml6ZSBmcm9tIFwiLi4vLi4vbWlkZGxld2FyZS9hdXRoXCJcclxuZnVuY3Rpb24gdmFsaWRFbWFpbChlbWFpbCkge1xyXG4gIHJldHVybiAgL15cXHcrKFtcXC4tXT9cXHcrKSpAXFx3KyhbXFwuLV0/XFx3KykqKFxcLlxcd3syLDN9KSskLy50ZXN0KGVtYWlsKTtcclxufVxyXG4gYXN5bmMgZnVuY3Rpb24gIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICAgICAgICBpZihyZXEubWV0aG9kID09IFwiUE9TVFwiKXtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIDEgZGVzdHJ1Y3R1cmUgdGhlIHJlcS5ib2R5IFxyXG4gICAgICAgICAgICAgICAgY29uc3Qge2VtYWlsLHBhc3N3b3JkfSA9IHJlcS5ib2R5XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCFbZW1haWwsIHBhc3N3b3JkXS5ldmVyeShCb29sZWFuKSkge1xyXG4gICAgICAgICAgICAgICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7ZXJyb3I6XCJNaXNzaW5nIENyZWRlbnRpYWxzXCJ9KTtcclxuICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF2YWxpZEVtYWlsKGVtYWlsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgcmVzLmpzb24oe2Vycm9yOiBcIkludmFsaWQgRW1haWxcIn0pO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIDIgY2hlY2sgaWYgdXNlciBkb2Vzbix0IGV4aXN0IChpZiBub3QgdGhlbiB0aHJvdyBlcnJvcilcclxuICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjb25uLnF1ZXJ5KFwiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VyX2VtYWlsID0gJDFcIixcclxuICAgICAgICAgICAgICAgIFtlbWFpbF0pO1xyXG4gICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCF1c2VyKXtcclxuICAgICAgICAgICAgICAgcmVzLmpzb24oe2Vycm9yOlwiZW1haWwgZG9lcyBub3QgZXhpc3QgXCJ9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZih1c2VyLnJvd3MubGVuZ3RoID09PSAwKXtcclxuICAgICAgICAgICAgICAgICAgIHJlcy5qc29uKHtlcnJvcjpcInBhc3N3b3JkIG9yIGVtYWlsIGlzIGluY29ycmVjdFwifSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gMyBjaGVjayBpZiBpbmNvbW1pbmcgcGFzc3dvcmQgaXMgdGhlIHNhbWUgdGhlIGRhdGFiYXNlIHBhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWxpZFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsdXNlci5yb3dzWzBdLnVzZXJfcGFzc3dvcmQpXHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgaWYoIXZhbGlkUGFzc3dvcmQpe1xyXG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oe2Vycm9yOlwicGFzc3dvcmQgb3IgZW1haWwgaXMgaW5jcnJvY3RcIn0pXHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gNCBnaXZlbiB0aGVtIGp3dCB0b2tlblxyXG4gICAgICAgICAgICAgICAgY29uc3QgdG9rZW4gID0gand0R2VuKHVzZXIucm93c1swXS51c2VyX2lkKVxyXG4gICAgICAgICAgICAgICAgcmVzLmpzb24oe3Rva2VuLCB1c2VyOiB1c2VyLnJvd3N9KVxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICBcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IGRlZmF1bHQgYXV0aG9yaXplKGhhbmRsZXIpICJdLCJuYW1lcyI6WyJjb25uIiwiYmNyeXB0IiwicmVxdWlyZSIsImp3dEdlbiIsImF1dGhvcml6ZSIsInZhbGlkRW1haWwiLCJlbWFpbCIsInRlc3QiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwicGFzc3dvcmQiLCJib2R5IiwiZXZlcnkiLCJCb29sZWFuIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwidXNlciIsInF1ZXJ5Iiwicm93cyIsImxlbmd0aCIsInZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwidXNlcl9wYXNzd29yZCIsInRva2VuIiwidXNlcl9pZCIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/login.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/login.js"));
module.exports = __webpack_exports__;

})();