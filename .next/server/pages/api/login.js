"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/login";
exports.ids = ["pages/api/login"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "cors":
/*!***********************!*\
  !*** external "cors" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("cors");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("dotenv");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "(api)/./jwtgenrate/jwttoken.js":
/*!********************************!*\
  !*** ./jwtgenrate/jwttoken.js ***!
  \********************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\nfunction jwtGen(user_id) {\n    const payload = {\n        user: user_id\n    };\n    return jwt.sign(payload, process.env.jwtSecret, {\n        expiresIn: \"1hr\"\n    });\n}\nmodule.exports = jwtGen;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9qd3RnZW5yYXRlL2p3dHRva2VuLmpzLmpzIiwibWFwcGluZ3MiOiJBQUNBO0FBQUEsTUFBTUEsR0FBRyxHQUFHQyxtQkFBTyxDQUFDLGtDQUFjLENBQUM7QUFJbkMsU0FBU0MsTUFBTSxDQUFDQyxPQUFPLEVBQUM7SUFDaEIsTUFBTUMsT0FBTyxHQUFHO1FBQ1pDLElBQUksRUFBRUYsT0FBTztLQUNoQjtJQUNILE9BQU9ILEdBQUcsQ0FBQ00sSUFBSSxDQUFDRixPQUFPLEVBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTLEVBQUM7UUFBQ0MsU0FBUyxFQUFFLEtBQUs7S0FBQyxDQUFDO0NBQ3RFO0FBRURDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHVixNQUFNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVzdGZyb250Ly4vand0Z2VucmF0ZS9qd3R0b2tlbi5qcz84N2UwIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5jb25zdCBqd3QgPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGp3dEdlbih1c2VyX2lkKXtcclxuICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xyXG4gICAgICAgICAgICB1c2VyOiB1c2VyX2lkXHJcbiAgICAgICAgfVxyXG4gICAgICByZXR1cm4gand0LnNpZ24ocGF5bG9hZCxwcm9jZXNzLmVudi5qd3RTZWNyZXQse2V4cGlyZXNJbjogXCIxaHJcIn0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gand0R2VuIl0sIm5hbWVzIjpbImp3dCIsInJlcXVpcmUiLCJqd3RHZW4iLCJ1c2VyX2lkIiwicGF5bG9hZCIsInVzZXIiLCJzaWduIiwicHJvY2VzcyIsImVudiIsImp3dFNlY3JldCIsImV4cGlyZXNJbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./jwtgenrate/jwttoken.js\n");

/***/ }),

/***/ "(api)/./middleware/auth.js":
/*!****************************!*\
  !*** ./middleware/auth.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _pages_api_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../pages/api/db */ \"(api)/./pages/api/db.js\");\nconst jwt = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n(__webpack_require__(/*! dotenv */ \"dotenv\").config)();\n\nconst authorize = (handler)=>{\n    return async (req, res)=>{\n        try {\n            const email = req.body.email;\n            const user = await _pages_api_db__WEBPACK_IMPORTED_MODULE_0__.conn.query(\"SELECT * from users where user_email = $1\", [\n                email\n            ]);\n            if (!user.rows[0].user_email == email) {\n                res.status(401).json({\n                    error: \"user does not exist\"\n                });\n                console.log(\"no users\");\n            } else if (user.rows[0].verify != 1) {\n                console.log(user.rows[0].verify);\n                res.status(401).json({\n                    error: \"Email is not verified please verify your account\"\n                });\n            }\n        } catch (error) {\n            console.log(error);\n        }\n        return handler(req, res);\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (authorize);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9taWRkbGV3YXJlL2F1dGguanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxNQUFNQSxHQUFHLEdBQUdDLG1CQUFPLENBQUMsa0NBQWMsQ0FBQztBQUNuQ0Esb0RBQXdCLEVBQUU7QUFDWTtBQUN0QyxNQUFNRyxTQUFTLEdBQUcsQ0FBQ0MsT0FBTyxHQUFJO0lBQzlCLE9BQU8sT0FBTUMsR0FBRyxFQUFDQyxHQUFHLEdBQUk7UUFDcEIsSUFBSTtZQUNBLE1BQU1DLEtBQUssR0FBR0YsR0FBRyxDQUFDRyxJQUFJLENBQUNELEtBQUs7WUFFN0IsTUFBTUUsSUFBSSxHQUFHLE1BQU1QLHFEQUFVLENBQUMsMkNBQTJDLEVBQUM7Z0JBQUNLLEtBQUs7YUFBQyxDQUFDO1lBRWxGLElBQUcsQ0FBQ0UsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUVDLFVBQVUsSUFBSUwsS0FBSyxFQUFDO2dCQUNyQ0QsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBQ0MsS0FBSyxFQUFDLHFCQUFxQjtpQkFBQyxDQUFDO2dCQUNuREMsT0FBTyxDQUFDQyxHQUFHLENBQUMsVUFBVSxDQUFDO2FBQ3ZCLE1BRUcsSUFBR1IsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNPLE1BQU0sSUFBSSxDQUFDLEVBQUM7Z0JBQy9CRixPQUFPLENBQUNDLEdBQUcsQ0FBQ1IsSUFBSSxDQUFDRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNPLE1BQU0sQ0FBQztnQkFDaENaLEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUNDLEtBQUssRUFBQyxrREFBa0Q7aUJBQUMsQ0FBQzthQUNoRjtTQUdILENBQUMsT0FBT0EsS0FBSyxFQUFFO1lBQ1pDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixLQUFLLENBQUM7U0FFckI7UUFDRCxPQUFPWCxPQUFPLENBQUNDLEdBQUcsRUFBQ0MsR0FBRyxDQUFDO0tBQzFCO0NBQ0E7QUFFRCxpRUFBZUgsU0FBUyIsInNvdXJjZXMiOlsid2VicGFjazovL3Rlc3Rmcm9udC8uL21pZGRsZXdhcmUvYXV0aC5qcz8xYzljIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXHJcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXHJcbmltcG9ydCB7IGNvbm4gfSBmcm9tICcuLi9wYWdlcy9hcGkvZGInXHJcbmNvbnN0IGF1dGhvcml6ZSA9IChoYW5kbGVyKSA9PntcclxucmV0dXJuIGFzeW5jKHJlcSxyZXMpID0+e1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBlbWFpbCA9IHJlcS5ib2R5LmVtYWlsXHJcbiAgICAgICAgXHJcbiAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgY29ubi5xdWVyeSgnU0VMRUNUICogZnJvbSB1c2VycyB3aGVyZSB1c2VyX2VtYWlsID0gJDEnLFtlbWFpbF0pO1xyXG4gICAgICAgXHJcbiAgICAgICBpZighdXNlci5yb3dzWzBdLiB1c2VyX2VtYWlsID09IGVtYWlsKXtcclxuICAgICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7ZXJyb3I6XCJ1c2VyIGRvZXMgbm90IGV4aXN0XCJ9KVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdubyB1c2VycycpXHJcbiAgICAgICB9XHJcbiAgICAgICBcclxuICAgICAgZWxzZSBpZih1c2VyLnJvd3NbMF0udmVyaWZ5ICE9IDEpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHVzZXIucm93c1swXS52ZXJpZnkpXHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDEpLmpzb24oe2Vycm9yOlwiRW1haWwgaXMgbm90IHZlcmlmaWVkIHBsZWFzZSB2ZXJpZnkgeW91ciBhY2NvdW50XCJ9KSAgXHJcbiAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgIFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhbmRsZXIocmVxLHJlcylcclxufVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhdXRob3JpemUiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImNvbmZpZyIsImNvbm4iLCJhdXRob3JpemUiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiZW1haWwiLCJib2R5IiwidXNlciIsInF1ZXJ5Iiwicm93cyIsInVzZXJfZW1haWwiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwidmVyaWZ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./middleware/auth.js\n");

/***/ }),

/***/ "(api)/./pages/api/db.js":
/*!*************************!*\
  !*** ./pages/api/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"conn\": () => (/* binding */ conn)\n/* harmony export */ });\n// import { Pool } from \"pg\";\n// let conn;\n// if(!conn){\n//     conn = new Pool({\n//         user: 'postgres',\n//         password: 'Thebalochcoder',\n//         host: 'localhost',\n//         port: 5432,\n//         database: 'testphase'\n//     });\n// }\n// export { conn };\n//  CLOUDE CONNECTION \nvar pg = __webpack_require__(/*! pg */ \"pg\");\n//or native libpq bindings\n//var pg = require('pg').native\nvar conString = process.env.DATABASE_URL //Can be found in the Details page\n;\nvar conn = new pg.Client(conString);\nconn.connect(function(err) {\n    if (err) {\n        console.error(\"could not connect to postgres\", err);\n        return conn = null;\n    }\n    conn.query('SELECT NOW() AS \"theTime\"', function(err, result) {\n        if (err) {\n            return console.error(\"error running query\", err);\n        }\n        console.log(\"DATABASE CONNECTED\");\n    // >> output: 2018-08-23T14:02:57.117Z\n    });\n});\n // CONNECTION POLLING METHOD\n // const { Pool } = require(\"pg\")\n // const pool = new Pool()\n // async function conn() {\n //   const client = await pool.connect()\n //   try {\n //     const res = await client.query(\"SELECT * FROM users WHERE id = $1\", [1])\n //     console.log(res.rows[0])\n //   } finally {\n //     await client.release()\n //     await client.end()\n //   }\n // }\n // export {conn}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZGIuanMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLDZCQUE2QjtBQUU3QixZQUFZO0FBQ1osYUFBYTtBQUNiLHdCQUF3QjtBQUN4Qiw0QkFBNEI7QUFDNUIsc0NBQXNDO0FBQ3RDLDZCQUE2QjtBQUM3QixzQkFBc0I7QUFDdEIsZ0NBQWdDO0FBQ2hDLFVBQVU7QUFFVixJQUFJO0FBRUosbUJBQW1CO0FBR25CLHNCQUFzQjtBQUN0QixJQUFJQSxFQUFFLEdBQUdDLG1CQUFPLENBQUMsY0FBSSxDQUFDO0FBQ3RCLDBCQUEwQjtBQUMxQiwrQkFBK0I7QUFFL0IsSUFBSUMsU0FBUyxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsWUFBWSxDQUFDLGtDQUFrQztBQUFuQztBQUN4QyxJQUFJQyxJQUFJLEdBQUksSUFBSU4sRUFBRSxDQUFDTyxNQUFNLENBQUNMLFNBQVMsQ0FBQztBQUNuQ0ksSUFBSSxDQUFDRSxPQUFPLENBQUMsU0FBU0MsR0FBRyxFQUFFO0lBQzFCLElBQUdBLEdBQUcsRUFBRTtRQUNOQyxPQUFPLENBQUNDLEtBQUssQ0FBQywrQkFBK0IsRUFBRUYsR0FBRyxDQUFDLENBQUM7UUFDcEQsT0FBT0gsSUFBSSxHQUFHLElBQUksQ0FBQztLQUNwQjtJQUNDQSxJQUFJLENBQUNNLEtBQUssQ0FBQywyQkFBMkIsRUFBRSxTQUFTSCxHQUFHLEVBQUVJLE1BQU0sRUFBRTtRQUM5RCxJQUFHSixHQUFHLEVBQUU7WUFDTixPQUFPQyxPQUFPLENBQUNDLEtBQUssQ0FBQyxxQkFBcUIsRUFBRUYsR0FBRyxDQUFDLENBQUM7U0FDbEQ7UUFDQ0MsT0FBTyxDQUFDSSxHQUFHLENBQUMsb0JBQW9CLENBQUM7SUFPbkMsc0NBQXNDO0tBRXZDLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQztBQUdhLENBRWhCLDRCQUE0QjtDQUc1QixpQ0FBaUM7Q0FDakMsMEJBQTBCO0NBRTFCLDBCQUEwQjtDQUMxQix3Q0FBd0M7Q0FDeEMsVUFBVTtDQUNWLCtFQUErRTtDQUMvRSwrQkFBK0I7Q0FDL0IsZ0JBQWdCO0NBQ2hCLDZCQUE2QjtDQUM3Qix5QkFBeUI7Q0FDekIsTUFBTTtDQUNOLElBQUk7Q0FDSixnQkFBZ0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXN0ZnJvbnQvLi9wYWdlcy9hcGkvZGIuanM/YjgxNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBQb29sIH0gZnJvbSBcInBnXCI7XHJcblxyXG4vLyBsZXQgY29ubjtcclxuLy8gaWYoIWNvbm4pe1xyXG4vLyAgICAgY29ubiA9IG5ldyBQb29sKHtcclxuLy8gICAgICAgICB1c2VyOiAncG9zdGdyZXMnLFxyXG4vLyAgICAgICAgIHBhc3N3b3JkOiAnVGhlYmFsb2NoY29kZXInLFxyXG4vLyAgICAgICAgIGhvc3Q6ICdsb2NhbGhvc3QnLFxyXG4vLyAgICAgICAgIHBvcnQ6IDU0MzIsXHJcbi8vICAgICAgICAgZGF0YWJhc2U6ICd0ZXN0cGhhc2UnXHJcbi8vICAgICB9KTtcclxuIFxyXG4vLyB9XHJcbiAgXHJcbi8vIGV4cG9ydCB7IGNvbm4gfTtcclxuICAgXHJcblxyXG4vLyAgQ0xPVURFIENPTk5FQ1RJT04gXHJcbnZhciBwZyA9IHJlcXVpcmUoJ3BnJylcclxuLy9vciBuYXRpdmUgbGlicHEgYmluZGluZ3NcclxuLy92YXIgcGcgPSByZXF1aXJlKCdwZycpLm5hdGl2ZVxyXG5cclxudmFyIGNvblN0cmluZyA9IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCAvL0NhbiBiZSBmb3VuZCBpbiB0aGUgRGV0YWlscyBwYWdlXHJcbnZhciBjb25uICA9IG5ldyBwZy5DbGllbnQoY29uU3RyaW5nKTtcclxuIGNvbm4uY29ubmVjdChmdW5jdGlvbihlcnIpIHtcclxuICBpZihlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ2NvdWxkIG5vdCBjb25uZWN0IHRvIHBvc3RncmVzJywgZXJyKTtcclxuICAgIHJldHVybiBjb25uID0gbnVsbDtcclxuICB9XHJcbiAgICBjb25uLnF1ZXJ5KCdTRUxFQ1QgTk9XKCkgQVMgXCJ0aGVUaW1lXCInLCBmdW5jdGlvbihlcnIsIHJlc3VsdCkge1xyXG4gICAgaWYoZXJyKSB7XHJcbiAgICAgIHJldHVybiBjb25zb2xlLmVycm9yKCdlcnJvciBydW5uaW5nIHF1ZXJ5JywgZXJyKTtcclxuICAgIH1cclxuICAgICAgY29uc29sZS5sb2coXCJEQVRBQkFTRSBDT05ORUNURURcIilcclxuICAgICAgICBcclxuICAgICBcclxuICAgICBcclxuICAgIFxyXG4gICAgIFxyXG4gICAgXHJcbiAgICAvLyA+PiBvdXRwdXQ6IDIwMTgtMDgtMjNUMTQ6MDI6NTcuMTE3WlxyXG4gXHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuXHJcbmV4cG9ydCB7IGNvbm4gfTtcclxuXHJcbi8vIENPTk5FQ1RJT04gUE9MTElORyBNRVRIT0RcclxuXHJcblxyXG4vLyBjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoXCJwZ1wiKVxyXG4vLyBjb25zdCBwb29sID0gbmV3IFBvb2woKVxyXG5cclxuLy8gYXN5bmMgZnVuY3Rpb24gY29ubigpIHtcclxuLy8gICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKVxyXG4vLyAgIHRyeSB7XHJcbi8vICAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQucXVlcnkoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gJDFcIiwgWzFdKVxyXG4vLyAgICAgY29uc29sZS5sb2cocmVzLnJvd3NbMF0pXHJcbi8vICAgfSBmaW5hbGx5IHtcclxuLy8gICAgIGF3YWl0IGNsaWVudC5yZWxlYXNlKClcclxuLy8gICAgIGF3YWl0IGNsaWVudC5lbmQoKVxyXG4vLyAgIH1cclxuLy8gfVxyXG4vLyBleHBvcnQge2Nvbm59Il0sIm5hbWVzIjpbInBnIiwicmVxdWlyZSIsImNvblN0cmluZyIsInByb2Nlc3MiLCJlbnYiLCJEQVRBQkFTRV9VUkwiLCJjb25uIiwiQ2xpZW50IiwiY29ubmVjdCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInF1ZXJ5IiwicmVzdWx0IiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/db.js\n");

/***/ }),

/***/ "(api)/./pages/api/login.js":
/*!****************************!*\
  !*** ./pages/api/login.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(api)/./pages/api/db.js\");\n/* harmony import */ var _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../jwtgenrate/jwttoken */ \"(api)/./jwtgenrate/jwttoken.js\");\n/* harmony import */ var _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _middleware_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../middleware/auth */ \"(api)/./middleware/auth.js\");\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! cors */ \"cors\");\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(cors__WEBPACK_IMPORTED_MODULE_3__);\n\nconst bcrypt = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n\n\n\n// Initialize the CORS middleware\nconst cors = cors__WEBPACK_IMPORTED_MODULE_3___default()({\n    methods: [\n        \"GET\",\n        \"POST\",\n        \"HEAD\"\n    ],\n    origin: \"*\" // Replace with the actual origin of your Next.js app\n});\n// Helper method to enable CORS for the API route\nfunction runMiddleware(req, res, fn) {\n    return new Promise((resolve, reject)=>{\n        fn(req, res, (result)=>{\n            if (result instanceof Error) {\n                return reject(result);\n            }\n            return resolve(result);\n        });\n    });\n}\nfunction validEmail(email) {\n    return /^\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+$/.test(email);\n}\nasync function handler(req, res) {\n    await runMiddleware(req, res, cors);\n    if (req.method == \"POST\") {\n        try {\n            // 1 destructure the req.body \n            const { email , password  } = req.body;\n            if (![\n                email,\n                password\n            ].every(Boolean)) {\n                res.status(400).json({\n                    error: \"Missing Credentials\"\n                });\n            } else if (!validEmail(email)) {\n                res.json({\n                    error: \"Invalid Email\"\n                });\n            }\n            // 2 check if user doesn,t exist (if not then throw error)\n            const user = await _db__WEBPACK_IMPORTED_MODULE_0__.conn.query(\"SELECT * FROM users WHERE user_email = $1\", [\n                email\n            ]);\n            if (!user) {\n                res.json({\n                    error: \"email does not exist \"\n                });\n            }\n            if (user.rows.length === 0) {\n                res.json({\n                    error: \"password or email is incorrect\"\n                });\n            }\n            // 3 check if incomming password is the same the database password\n            const validPassword = await bcrypt.compare(password, user.rows[0].user_password);\n            if (!validPassword) {\n                return res.json({\n                    error: \"password or email is incrroct\"\n                });\n            }\n            // 4 given them jwt token\n            const token = _jwtgenrate_jwttoken__WEBPACK_IMPORTED_MODULE_1___default()(user.rows[0].user_id);\n            res.json({\n                token,\n                user: user.rows\n            });\n        } catch (error) {\n            console.log(error);\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_middleware_auth__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(handler));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUMyQixJQUFJLENBQUNFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQ00sT0FBTyxDQUFDO1lBQzNDM0IsR0FBRyxDQUFDaUIsSUFBSSxDQUFDO2dCQUFDUyxLQUFLO2dCQUFFUCxJQUFJLEVBQUVBLElBQUksQ0FBQ0UsSUFBSTthQUFDLENBQUM7U0FHbkMsQ0FBQyxPQUFPSCxLQUFLLEVBQUU7WUFDZFUsT0FBTyxDQUFDQyxHQUFHLENBQUNYLEtBQUssQ0FBQztTQUNuQjtLQUVOO0NBR047QUFFRCxpRUFBZXpCLDREQUFTLENBQUNpQixPQUFPLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXN0ZnJvbnQvLi9wYWdlcy9hcGkvbG9naW4uanM/YWU4OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2Nvbm59IGZyb20gXCIuL2RiXCJcclxuXHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXHJcbmltcG9ydCBqd3RHZW4gZnJvbSBcIi4uLy4uL2p3dGdlbnJhdGUvand0dG9rZW5cIlxyXG5cclxuXHJcbmltcG9ydCBhdXRob3JpemUgZnJvbSBcIi4uLy4uL21pZGRsZXdhcmUvYXV0aFwiXHJcblxyXG5pbXBvcnQgQ29ycyBmcm9tICdjb3JzJztcclxuXHJcbi8vIEluaXRpYWxpemUgdGhlIENPUlMgbWlkZGxld2FyZVxyXG5jb25zdCBjb3JzID0gQ29ycyh7XHJcbiAgbWV0aG9kczogWydHRVQnLCAnUE9TVCcsJ0hFQUQnXSwgLy8gU3BlY2lmeSB0aGUgYWxsb3dlZCBIVFRQIG1ldGhvZHMgaHR0cHM6Ly9lLWNvbW1lcmNlLW5leHQtYXAtcC52ZXJjZWwuYXBwXHJcbiAgb3JpZ2luOiAnKicgLy8gUmVwbGFjZSB3aXRoIHRoZSBhY3R1YWwgb3JpZ2luIG9mIHlvdXIgTmV4dC5qcyBhcHBcclxufSk7XHJcblxyXG4vLyBIZWxwZXIgbWV0aG9kIHRvIGVuYWJsZSBDT1JTIGZvciB0aGUgQVBJIHJvdXRlXHJcbmZ1bmN0aW9uIHJ1bk1pZGRsZXdhcmUocmVxLCByZXMsIGZuKSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGZuKHJlcSwgcmVzLCAocmVzdWx0KSA9PiB7XHJcbiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgIHJldHVybiByZWplY3QocmVzdWx0KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHJlc29sdmUocmVzdWx0KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkRW1haWwoZW1haWwpIHtcclxuICByZXR1cm4gIC9eXFx3KyhbXFwuLV0/XFx3KykqQFxcdysoW1xcLi1dP1xcdyspKihcXC5cXHd7MiwzfSkrJC8udGVzdChlbWFpbCk7XHJcbn1cclxuIGFzeW5jIGZ1bmN0aW9uICBoYW5kbGVyKHJlcSwgcmVzLCkge1xyXG4gIGF3YWl0IHJ1bk1pZGRsZXdhcmUocmVxLCByZXMsIGNvcnMpO1xyXG4gICAgICAgIGlmKHJlcS5tZXRob2QgPT0gXCJQT1NUXCIpe1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8gMSBkZXN0cnVjdHVyZSB0aGUgcmVxLmJvZHkgXHJcbiAgICAgICAgICAgICAgICBjb25zdCB7ZW1haWwscGFzc3dvcmR9ID0gcmVxLmJvZHlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoIVtlbWFpbCwgcGFzc3dvcmRdLmV2ZXJ5KEJvb2xlYW4pKSB7XHJcbiAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtlcnJvcjpcIk1pc3NpbmcgQ3JlZGVudGlhbHNcIn0pO1xyXG4gICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXZhbGlkRW1haWwoZW1haWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICByZXMuanNvbih7ZXJyb3I6IFwiSW52YWxpZCBFbWFpbFwifSk7XHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gMiBjaGVjayBpZiB1c2VyIGRvZXNuLHQgZXhpc3QgKGlmIG5vdCB0aGVuIHRocm93IGVycm9yKVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGNvbm4ucXVlcnkoXCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJfZW1haWwgPSAkMVwiLFxyXG4gICAgICAgICAgICAgICAgW2VtYWlsXSk7XHJcbiAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoIXVzZXIpe1xyXG4gICAgICAgICAgICAgICByZXMuanNvbih7ZXJyb3I6XCJlbWFpbCBkb2VzIG5vdCBleGlzdCBcIn0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKHVzZXIucm93cy5sZW5ndGggPT09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgcmVzLmpzb24oe2Vycm9yOlwicGFzc3dvcmQgb3IgZW1haWwgaXMgaW5jb3JyZWN0XCJ9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyAzIGNoZWNrIGlmIGluY29tbWluZyBwYXNzd29yZCBpcyB0aGUgc2FtZSB0aGUgZGF0YWJhc2UgcGFzc3dvcmRcclxuICAgICAgICAgICAgICAgIGNvbnN0IHZhbGlkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCx1c2VyLnJvd3NbMF0udXNlcl9wYXNzd29yZClcclxuICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICBpZighdmFsaWRQYXNzd29yZCl7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbih7ZXJyb3I6XCJwYXNzd29yZCBvciBlbWFpbCBpcyBpbmNycm9jdFwifSlcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyA0IGdpdmVuIHRoZW0gand0IHRva2VuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b2tlbiAgPSBqd3RHZW4odXNlci5yb3dzWzBdLnVzZXJfaWQpXHJcbiAgICAgICAgICAgICAgICByZXMuanNvbih7dG9rZW4sIHVzZXI6IHVzZXIucm93c30pXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgIFxyXG4gICAgXHJcbiAgfVxyXG5cclxuICBleHBvcnQgZGVmYXVsdCBhdXRob3JpemUoaGFuZGxlcikgIl0sIm5hbWVzIjpbImNvbm4iLCJiY3J5cHQiLCJyZXF1aXJlIiwiand0R2VuIiwiYXV0aG9yaXplIiwiQ29ycyIsImNvcnMiLCJtZXRob2RzIiwib3JpZ2luIiwicnVuTWlkZGxld2FyZSIsInJlcSIsInJlcyIsImZuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXN1bHQiLCJFcnJvciIsInZhbGlkRW1haWwiLCJlbWFpbCIsInRlc3QiLCJoYW5kbGVyIiwibWV0aG9kIiwicGFzc3dvcmQiLCJib2R5IiwiZXZlcnkiLCJCb29sZWFuIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwidXNlciIsInF1ZXJ5Iiwicm93cyIsImxlbmd0aCIsInZhbGlkUGFzc3dvcmQiLCJjb21wYXJlIiwidXNlcl9wYXNzd29yZCIsInRva2VuIiwidXNlcl9pZCIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/login.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/login.js"));
module.exports = __webpack_exports__;

})();